{
  "hash": "24b7b7921d49266eda2ae80762a13f41",
  "result": {
    "markdown": "---\ntitle: Univariate regression\ndescription: Description to go here\nauthor: David Harper, CFA, FRM\ndate: 2023-10-22\ncategories: [code, analysis]\nexecute: \n  echo: true\n  warning: false\n---\n\n\n### Contents\n\n-   Illustration of residual sum of squares (RSS) with n = 12 subset\n-   Univariate (aka, simple) linear regression: AAPL vs S&P 1500, n = 72 months\n-   Model diagnostics\n-   Autocorrelation test\n\nLoading packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse); library(gt)\nlibrary(patchwork)\n\nlibrary(broom); library(performance); library(lmtest)\nlibrary(desk)\n```\n:::\n\n\n## Regressing Apple's (AAPL) returns against S&P 1500\n\n### Subset of 12 months just to illustrate RSS boxes\n\nThe full set is 72 months of returns. The sample of 12 months is just to illustrate the residual sum of squares (RSS) concept; the squares are less cluttered.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_72 <- readRDS(\"t2-20-17-aapl-sp1500.rds\") # 72 monthly returns\nrow.names(data_72) <- 1:nrow(data_72)\nmodel_72 <- lm(r_m_AAPL ~ r_SP_1500, data = data_72) # linear model\n\nset.seed(97531) # Adding Y ~ X just because they're familiar axes\ndata_12 <- sample_n(data_72, 12) # sample of 12 monthly returns \ndata_12$y <- data_12$r_m_AAPL # just to illustrate RSS\ndata_12$x <- data_12$r_SP_1500\n\nmodel_12 <- lm(y ~ x, data=data_12) # linear model\ndata_12$residuals <- residuals(model_12)\n\nsum(model_12$residuals^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.0448225\n```\n:::\n\n```{.r .cell-code}\nRSS <- sum(model_12$residuals^2) \npred_Y <- predict(model_12)\n\n# colors for plots\ngreen_line = \"#3aaf85\"; blue_points = \"#1b6ca8\"; red_color = \"#cd201f\"\n\np1 <- data_12 |> ggplot(aes(x=x, y=y)) +\n    geom_point(size=3, color=blue_points) +\n    geom_smooth(method=\"lm\", se=FALSE, color=green_line) + # Adding regression line\n    theme_minimal() +\n    theme(axis.title = element_blank()) + \n    coord_cartesian(xlim = c(-0.15, 0.05), ylim = c(-0.15, 0.20))\n\np2 <- data_12 |> ggplot(aes(x=x, y=y)) +\n    geom_point(size=3, color=blue_points) +\n    geom_smooth(method=\"lm\", se=FALSE, color=green_line) + \n    # geom_segment(aes(xend=x, yend=y - residuals), color=red_color, linewidth = 1, linetype = \"dashed\") +\n    geom_rect(aes(xmin = x - abs(residuals),\n                  xmax = x, \n                  ymin = ifelse(residuals > 0, y - abs(residuals), y), \n                  ymax = ifelse(residuals > 0, y, y + abs(residuals))), \n              fill=\"purple4\", color=\"purple\", linewidth=0.5, alpha = 0.10) +\n    theme_minimal() +\n    theme(axis.title = element_blank()) + \n    coord_cartesian(xlim = c(-0.15, 0.05), ylim = c(-0.15, 0.20))\n\nscatter_pw <- p1 + p2 \nscatter_pw + plot_annotation(\n    title = \"The OLS line minimizes the residual sum of squares (RSS)\",\n    subtitle = sprintf(\"In ths case, RSS = %.4f\", RSS)\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# To show the residuals in a gt table\nresult_df <- data.frame(\n  X = data_12$x,\n  Y = data_12$y,\n  Pred_Y = pred_Y,\n  residual = model_12$residuals,\n  residual_sq = model_12$residuals^2\n)\n\n# But sorting by X = SP1500 \nresult_df_sorted <- result_df[order(result_df$X), ]\nresult_df_sorted_tbl <- gt(result_df_sorted)\np1_tbl <- result_df_sorted_tbl |> \n    fmt_percent(\n        columns = 1:4,\n        decimals = 2\n    ) |> \n    fmt_number(\n        columns = 5,\n        decimals = 5\n    ) |> \n    cols_label(\n        X = md(\"**S&P 1500**\"),\n        Y = md(\"**AAPL**\"),\n        Pred_Y = md(\"**Pred(AAPL)**\"),\n        residual = md(\"**Residual**\"),\n        residual_sq = md(\"**Residual^2**\")\n    ) |> \n    data_color(\n        columns = 5,\n        palette = c(\"white\",\"purple4\"),\n        domain = c(0,0.02),\n        na_color = \"lightgrey\"\n    ) |> \n    tab_options(\n        table.font.size = 12\n    )\n\np1_tbl\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"ssjxucselg\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ssjxucselg table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ssjxucselg thead, #ssjxucselg tbody, #ssjxucselg tfoot, #ssjxucselg tr, #ssjxucselg td, #ssjxucselg th {\n  border-style: none;\n}\n\n#ssjxucselg p {\n  margin: 0;\n  padding: 0;\n}\n\n#ssjxucselg .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 12px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ssjxucselg .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ssjxucselg .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ssjxucselg .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ssjxucselg .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ssjxucselg .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ssjxucselg .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ssjxucselg .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ssjxucselg .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ssjxucselg .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ssjxucselg .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ssjxucselg .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ssjxucselg .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ssjxucselg .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ssjxucselg .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ssjxucselg .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ssjxucselg .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ssjxucselg .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ssjxucselg .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ssjxucselg .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ssjxucselg .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ssjxucselg .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ssjxucselg .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ssjxucselg .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ssjxucselg .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ssjxucselg .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ssjxucselg .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ssjxucselg .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ssjxucselg .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ssjxucselg .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ssjxucselg .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ssjxucselg .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ssjxucselg .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ssjxucselg .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ssjxucselg .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ssjxucselg .gt_left {\n  text-align: left;\n}\n\n#ssjxucselg .gt_center {\n  text-align: center;\n}\n\n#ssjxucselg .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ssjxucselg .gt_font_normal {\n  font-weight: normal;\n}\n\n#ssjxucselg .gt_font_bold {\n  font-weight: bold;\n}\n\n#ssjxucselg .gt_font_italic {\n  font-style: italic;\n}\n\n#ssjxucselg .gt_super {\n  font-size: 65%;\n}\n\n#ssjxucselg .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ssjxucselg .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ssjxucselg .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ssjxucselg .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ssjxucselg .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ssjxucselg .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ssjxucselg .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;S&amp;amp;P 1500&lt;/strong&gt;\"><strong>S&amp;P 1500</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;AAPL&lt;/strong&gt;\"><strong>AAPL</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Pred(AAPL)&lt;/strong&gt;\"><strong>Pred(AAPL)</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Residual&lt;/strong&gt;\"><strong>Residual</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Residual^2&lt;/strong&gt;\"><strong>Residual^2</strong></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"X\" class=\"gt_row gt_right\">−9.15%</td>\n<td headers=\"Y\" class=\"gt_row gt_right\">−12.41%</td>\n<td headers=\"Pred_Y\" class=\"gt_row gt_right\">−11.61%</td>\n<td headers=\"residual\" class=\"gt_row gt_right\">−0.80%</td>\n<td headers=\"residual_sq\" class=\"gt_row gt_right\" style=\"background-color: #FEFEFF; color: #000000;\">0.00006</td></tr>\n    <tr><td headers=\"X\" class=\"gt_row gt_right\">−7.60%</td>\n<td headers=\"Y\" class=\"gt_row gt_right\">−3.10%</td>\n<td headers=\"Pred_Y\" class=\"gt_row gt_right\">−9.62%</td>\n<td headers=\"residual\" class=\"gt_row gt_right\">6.53%</td>\n<td headers=\"residual_sq\" class=\"gt_row gt_right\" style=\"background-color: #DCCCE6; color: #000000;\">0.00426</td></tr>\n    <tr><td headers=\"X\" class=\"gt_row gt_right\">−6.64%</td>\n<td headers=\"Y\" class=\"gt_row gt_right\">−13.26%</td>\n<td headers=\"Pred_Y\" class=\"gt_row gt_right\">−8.38%</td>\n<td headers=\"residual\" class=\"gt_row gt_right\">−4.88%</td>\n<td headers=\"residual_sq\" class=\"gt_row gt_right\" style=\"background-color: #EBE2F1; color: #000000;\">0.00238</td></tr>\n    <tr><td headers=\"X\" class=\"gt_row gt_right\">0.19%</td>\n<td headers=\"Y\" class=\"gt_row gt_right\">−4.36%</td>\n<td headers=\"Pred_Y\" class=\"gt_row gt_right\">0.40%</td>\n<td headers=\"residual\" class=\"gt_row gt_right\">−4.76%</td>\n<td headers=\"residual_sq\" class=\"gt_row gt_right\" style=\"background-color: #ECE4F2; color: #000000;\">0.00226</td></tr>\n    <tr><td headers=\"X\" class=\"gt_row gt_right\">0.42%</td>\n<td headers=\"Y\" class=\"gt_row gt_right\">0.58%</td>\n<td headers=\"Pred_Y\" class=\"gt_row gt_right\">0.70%</td>\n<td headers=\"residual\" class=\"gt_row gt_right\">−0.12%</td>\n<td headers=\"residual_sq\" class=\"gt_row gt_right\" style=\"background-color: #FFFFFF; color: #000000;\">0.00000</td></tr>\n    <tr><td headers=\"X\" class=\"gt_row gt_right\">0.55%</td>\n<td headers=\"Y\" class=\"gt_row gt_right\">−1.51%</td>\n<td headers=\"Pred_Y\" class=\"gt_row gt_right\">0.86%</td>\n<td headers=\"residual\" class=\"gt_row gt_right\">−2.37%</td>\n<td headers=\"residual_sq\" class=\"gt_row gt_right\" style=\"background-color: #FAF8FC; color: #000000;\">0.00056</td></tr>\n    <tr><td headers=\"X\" class=\"gt_row gt_right\">0.66%</td>\n<td headers=\"Y\" class=\"gt_row gt_right\">6.34%</td>\n<td headers=\"Pred_Y\" class=\"gt_row gt_right\">1.00%</td>\n<td headers=\"residual\" class=\"gt_row gt_right\">5.34%</td>\n<td headers=\"residual_sq\" class=\"gt_row gt_right\" style=\"background-color: #E8DDEE; color: #000000;\">0.00285</td></tr>\n    <tr><td headers=\"X\" class=\"gt_row gt_right\">1.00%</td>\n<td headers=\"Y\" class=\"gt_row gt_right\">−5.89%</td>\n<td headers=\"Pred_Y\" class=\"gt_row gt_right\">1.44%</td>\n<td headers=\"residual\" class=\"gt_row gt_right\">−7.34%</td>\n<td headers=\"residual_sq\" class=\"gt_row gt_right\" style=\"background-color: #D3BFE0; color: #000000;\">0.00538</td></tr>\n    <tr><td headers=\"X\" class=\"gt_row gt_right\">2.09%</td>\n<td headers=\"Y\" class=\"gt_row gt_right\">6.95%</td>\n<td headers=\"Pred_Y\" class=\"gt_row gt_right\">2.84%</td>\n<td headers=\"residual\" class=\"gt_row gt_right\">4.11%</td>\n<td headers=\"residual_sq\" class=\"gt_row gt_right\" style=\"background-color: #F1EBF5; color: #000000;\">0.00169</td></tr>\n    <tr><td headers=\"X\" class=\"gt_row gt_right\">3.18%</td>\n<td headers=\"Y\" class=\"gt_row gt_right\">2.76%</td>\n<td headers=\"Pred_Y\" class=\"gt_row gt_right\">4.25%</td>\n<td headers=\"residual\" class=\"gt_row gt_right\">−1.49%</td>\n<td headers=\"residual_sq\" class=\"gt_row gt_right\" style=\"background-color: #FDFCFE; color: #000000;\">0.00022</td></tr>\n    <tr><td headers=\"X\" class=\"gt_row gt_right\">3.42%</td>\n<td headers=\"Y\" class=\"gt_row gt_right\">18.27%</td>\n<td headers=\"Pred_Y\" class=\"gt_row gt_right\">4.55%</td>\n<td headers=\"residual\" class=\"gt_row gt_right\">13.72%</td>\n<td headers=\"residual_sq\" class=\"gt_row gt_right\" style=\"background-color: #602992; color: #FFFFFF;\">0.01883</td></tr>\n    <tr><td headers=\"X\" class=\"gt_row gt_right\">4.37%</td>\n<td headers=\"Y\" class=\"gt_row gt_right\">−2.18%</td>\n<td headers=\"Pred_Y\" class=\"gt_row gt_right\">5.77%</td>\n<td headers=\"residual\" class=\"gt_row gt_right\">−7.95%</td>\n<td headers=\"residual_sq\" class=\"gt_row gt_right\" style=\"background-color: #CBB4DA; color: #000000;\">0.00632</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n### The full dataset of 72 monthly returns\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrow.names(data_72) <- 1:nrow(data_72)\nmodel_72 <- lm(r_m_AAPL ~ r_SP_1500, data = data_72)\nmodel_72_coeff <- coef(model_72)\nequation_label <- sprintf(\"Y = %.3fX + %.3f\", model_72_coeff[2], model_72_coeff[1])\n\np1_model_72 <- data_72 %>% ggplot(aes(r_SP_1500, r_m_AAPL)) +\n    geom_point(size = 2, color = blue_points) +\n    geom_smooth(method = \"lm\", color = green_line, fill = \"mediumpurple1\", alpha = 0.20) +\n    theme_minimal() +\n    xlab(\"S&P 1500 return\") +\n    ylab(\"AAPL return\") + \n    annotate(\"text\", x = -0.06, y = 0.15, label = equation_label, \n             size = 5.0, color = \"black\")\n\np1_model_72\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\nsummary(model_72) # Just to show the standard/typical output\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = r_m_AAPL ~ r_SP_1500, data = data_72)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.226290 -0.027060  0.002344  0.040667  0.131313 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 0.007969   0.007477   1.066     0.29    \nr_SP_1500   1.269625   0.215600   5.889 1.23e-07 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.06123 on 70 degrees of freedom\nMultiple R-squared:  0.3313,\tAdjusted R-squared:  0.3217 \nF-statistic: 34.68 on 1 and 70 DF,  p-value: 1.23e-07\n```\n:::\n:::\n\n\n### Model output in gt table\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_72_tidy <- tidy(model_72)\ngt_table_model_72 <- gt(model_72_tidy)\n\ngt_table_model_72 <- \n  gt_table_model_72 %>% \n  tab_options(\n    table.font.size = 14\n  ) %>% \n  tab_style(\n    style = cell_text(weight = \"bold\"),\n    locations = cells_body()\n  ) %>% \n  tab_header(\n    title = \"AAPL versus S&P_1500: Gross (incl. Rf) monthly log return\",\n    subtitle = md(\"Six years (2014 - 2019), n = 72 months\")\n  ) %>% \n  tab_source_note(\n    source_note = \"Source: tidyquant https://cran.r-project.org/web/packages/tidyquant/\"\n  ) %>% cols_label(\n    term = \"Coefficient\",\n    estimate = \"Estimate\",\n    std.error = \"Std Error\",\n    statistic = \"t-stat\",\n    p.value = \"p value\"\n  ) %>% fmt_number(\n    columns = vars(estimate, std.error, statistic),\n    decimals = 3\n  ) %>% fmt_scientific(\n    columns = vars(p.value),\n  ) %>% \n  tab_options(\n    heading.title.font.size = 14,\n    heading.subtitle.font.size = 12\n  )\n\ngt_table_model_72\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"ijqyeeyjtu\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ijqyeeyjtu table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ijqyeeyjtu thead, #ijqyeeyjtu tbody, #ijqyeeyjtu tfoot, #ijqyeeyjtu tr, #ijqyeeyjtu td, #ijqyeeyjtu th {\n  border-style: none;\n}\n\n#ijqyeeyjtu p {\n  margin: 0;\n  padding: 0;\n}\n\n#ijqyeeyjtu .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 14px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ijqyeeyjtu .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ijqyeeyjtu .gt_title {\n  color: #333333;\n  font-size: 14px;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ijqyeeyjtu .gt_subtitle {\n  color: #333333;\n  font-size: 12px;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ijqyeeyjtu .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ijqyeeyjtu .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ijqyeeyjtu .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ijqyeeyjtu .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ijqyeeyjtu .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ijqyeeyjtu .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ijqyeeyjtu .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ijqyeeyjtu .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ijqyeeyjtu .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ijqyeeyjtu .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ijqyeeyjtu .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ijqyeeyjtu .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ijqyeeyjtu .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ijqyeeyjtu .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ijqyeeyjtu .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ijqyeeyjtu .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ijqyeeyjtu .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ijqyeeyjtu .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ijqyeeyjtu .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ijqyeeyjtu .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ijqyeeyjtu .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ijqyeeyjtu .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ijqyeeyjtu .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ijqyeeyjtu .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ijqyeeyjtu .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ijqyeeyjtu .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ijqyeeyjtu .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ijqyeeyjtu .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ijqyeeyjtu .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ijqyeeyjtu .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ijqyeeyjtu .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ijqyeeyjtu .gt_left {\n  text-align: left;\n}\n\n#ijqyeeyjtu .gt_center {\n  text-align: center;\n}\n\n#ijqyeeyjtu .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ijqyeeyjtu .gt_font_normal {\n  font-weight: normal;\n}\n\n#ijqyeeyjtu .gt_font_bold {\n  font-weight: bold;\n}\n\n#ijqyeeyjtu .gt_font_italic {\n  font-style: italic;\n}\n\n#ijqyeeyjtu .gt_super {\n  font-size: 65%;\n}\n\n#ijqyeeyjtu .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ijqyeeyjtu .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ijqyeeyjtu .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ijqyeeyjtu .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ijqyeeyjtu .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ijqyeeyjtu .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ijqyeeyjtu .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"5\" class=\"gt_heading gt_title gt_font_normal\" style>AAPL versus S&amp;P_1500: Gross (incl. Rf) monthly log return</td>\n    </tr>\n    <tr class=\"gt_heading\">\n      <td colspan=\"5\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>Six years (2014 - 2019), n = 72 months</td>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Coefficient\">Coefficient</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Estimate\">Estimate</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Std Error\">Std Error</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"t-stat\">t-stat</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p value\">p value</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"term\" class=\"gt_row gt_left\" style=\"font-weight: bold;\">(Intercept)</td>\n<td headers=\"estimate\" class=\"gt_row gt_right\" style=\"font-weight: bold;\">0.008</td>\n<td headers=\"std.error\" class=\"gt_row gt_right\" style=\"font-weight: bold;\">0.007</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\" style=\"font-weight: bold;\">1.066</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\" style=\"font-weight: bold;\">2.90 × 10<sup style='font-size: 65%;'>−1</sup></td></tr>\n    <tr><td headers=\"term\" class=\"gt_row gt_left\" style=\"font-weight: bold;\">r_SP_1500</td>\n<td headers=\"estimate\" class=\"gt_row gt_right\" style=\"font-weight: bold;\">1.270</td>\n<td headers=\"std.error\" class=\"gt_row gt_right\" style=\"font-weight: bold;\">0.216</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\" style=\"font-weight: bold;\">5.889</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\" style=\"font-weight: bold;\">1.23 × 10<sup style='font-size: 65%;'>−7</sup></td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"5\">Source: tidyquant https://cran.r-project.org/web/packages/tidyquant/</td>\n    </tr>\n  </tfoot>\n  \n</table>\n</div>\n```\n:::\n:::\n\n\nThe table above is featured in one of my [practice questions](https://forum.bionicturtle.com/threads/p1-t2-20-17-hypothesis-tests-of-univariate-linear-regression-model.23451/):\n\n::: {.callout-note icon=\"false\"}\n## BT Question 20.17.1\n\nBelow \\[above\\] the results of a linear regression analysis are displayed. The dataset is monthly returns over a six-year period; i.e., n = 72 months. The gross returns of Apple's stock (ticker: AAPL) were regressed against the S&P 1500 Index (the S&P 1500 is our proxy for the market). The explanatory variable is SP_1500 and the response (aka, dependent) variable is AAPL.\n\nWhich is nearest to the 90.0% confidence interval for the beta of Apple's (AAPL) stock?\n\na.  90.0% CI = (0.56; 1.98)\nb.  90.0% CI = (0.70; 1.84)\nc.  90.0% CI = (0.91; 1.63)\nd.  90.0% CI = (-0.004; 0.020)\n:::\n\n::: callout-tip\n## Answer: C. True: 90.0% CI = (0.91; 1.63)\n\nThe two-tailed critical-Z at 90.0% confidence is 1.645 such that the CI = 1.270 +/- 1.645 × 0.216 = (0.91; 1.63). The confidence interval is given by: coefficient ± (standard error) × (critical value). The sample size is large so we can use the normal deviate of 1.645 associated with 90.0% two-tailed confidence; note this should not require any lookup because we already know the 95.0% confident one-tailed normal deviate is 1.645. With 70 degrees of freedom, the critical t value is T.INV.2T(0.10, 70) = 1.666914, so we can see that normal Z is a close approximation.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Confidence interval around the slope\nbeta <- model_72_tidy$estimate[2]\nse_beta <- model_72_tidy$std.error[2]\nci_confidence = 0.90\nz_2s <- qnorm((1 + ci_confidence)/2)\nci_lower <- beta - se_beta*z_2s\nci_upper <- beta + se_beta*z_2s\n\nci_lower\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.9149948\n```\n:::\n\n```{.r .cell-code}\nci_upper\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.624256\n```\n:::\n:::\n\n\n## Model diagnostics\n\nThere are many choices but I like the [performance package](https://easystats.github.io/performance/).\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_model(model_72, check = c(\"linearity\", \"homogeneity\", \"outliers\", \"qq\"))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nIn regard to the above:\n\n-   *Linearity* plot; aka, *Tukey-Anscombe*\n-   *Homogeneity* (of variance); aka, *scale-location* plot\n-   *Outliers* (Influential Observations) uses *Cook's distance*\n-   *Q-Q plot* is test of residual normality\n\nBoth of the first two plots (upper row) can be used to check for heteroscedasticity. The second is supposedly better: by rooting the absolute value, differences are amplified. Notice it's Y-axis (Homogeneity of Variance) is non-negative such that the \"perfect\" reference line is nearer to one than zero.\n\n## Autocorrelation tests\n\nFirst, Durbin-Watson with [check_autocorrelation()](https://easystats.github.io/performance/reference/check_autocorrelation.html) in performance package:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_autocorrelation(model_72)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Residuals appear to be independent and not autocorrelated (p = 0.068).\n```\n:::\n:::\n\n\nLet's plot residual against lag 1 residual.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresiduals_72 <- residuals(model_72)\nlagged_residuals_72 <- c(NA, residuals_72[-length(residuals_72)])\n\nresidual_data <- data.frame(\n  Residuals = residuals_72[-1],  # Exclude the first value as it doesn't have a lagged residual\n  Lagged_Residuals = lagged_residuals_72[-1]  # Exclude the last value as it is NA\n)\n\nggplot(residual_data, aes(x = Lagged_Residuals, y = Residuals)) +\n  geom_point(color = blue_points) +\n  labs(title = \"Scatter Plot of Residuals vs. Lagged Residuals\",\n       x = \"Lagged Residuals (i-1)\",\n       y = \"Residuals (i)\") +\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = green_line) +\n  geom_vline(xintercept = 0, linetype = \"dashed\", color = green_line) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\nlinear_model <- lm(Residuals ~ Lagged_Residuals, data = residual_data)\nlinear_model\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Residuals ~ Lagged_Residuals, data = residual_data)\n\nCoefficients:\n     (Intercept)  Lagged_Residuals  \n        0.001015         -0.218861  \n```\n:::\n\n```{.r .cell-code}\ncor(residual_data$Residuals, residual_data$Lagged_Residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -0.2207468\n```\n:::\n\n```{.r .cell-code}\nsummary(linear_model)$r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.04872914\n```\n:::\n\n```{.r .cell-code}\ncor(residual_data$Residuals, residual_data$Lagged_Residuals)^2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.04872914\n```\n:::\n:::\n\n\nFinally, let's try dw.test from the [desk package](https://github.com/OvGU-SH/desk) which is new but looks good:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndw.test(model_72, dir = \"left\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nDurbin-Watson Test on AR(1) autocorrelation \n--------------------------------------------\n\nHypotheses: \n                              H0:                         H1:\n  d >= 2 (rho <= 0, no pos. a.c.)  d < 2 (rho > 0, pos. a.c.)\n\nTest results: \n      dw  crit.value  p.value  sig.level            H0\n  2.3979      1.6107   0.9589       0.05  not rejected\n```\n:::\n\n```{.r .cell-code}\ndw.test(model_72, dir = \"right\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nDurbin-Watson Test on AR(1) autocorrelation \n--------------------------------------------\n\nHypotheses: \n                              H0:                         H1:\n  d <= 2 (rho >= 0, no neg. a.c.)  d > 2 (rho < 0, neg. a.c.)\n\nTest results: \n      dw  crit.value  p.value  sig.level        H0\n  2.3979      2.3765   0.0411       0.05  rejected\n```\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}