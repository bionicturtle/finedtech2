{
  "hash": "0d2588e2c1ea081c016e3740e41c76f3",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Creativity as temperature in LLMs\ndescription: The softmax function converts a numeric vector into a probabilty distribution\nauthor: David Harper, CFA, FRM\ndate: 2024-05-12\ncategories: [code, analysis]\nexecute: \n  echo: true\n  warning: false\n---\n\n\nI liked Logan Thorneloe's swift explainer of LLM *temperature* in his [What you need to understand about LLM creativity](https://societysbackend.com/p/temperature-in-llms). Below I illustrate the softmax function with a dead-simple example. Let's just assume the sentence begins \"We live in Los Angeles, tomorrow we will travel to the ...\" where the **possible** location-destinations are found in the vector {beach, mountains, lake, mall, park, city}. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(tidyr)\n\nsoftmax <- function(values, temps) {\n  words <- names(values) \n  \n  # Below is the softmax function\n  exp_values <- exp(outer(values, 1 / temps))\n  softmax_values <- sweep(exp_values, 2, colSums(exp_values), `/`)\n  \n  data.frame(\n    temp = rep(temps, each = length(values)),\n    word = rep(words, times = length(temps)),\n    prob = c(softmax_values)\n  )\n}\n\n# We live in Los Angeles, tomorrow we will travel to the ..\nvalues <- c(\"beach\"     = 9.1,\n            \"mountains\" = 7.2, \n            \"lake\"      = 5.8,\n            \"mall\"      = 3.4,\n            \"park\"      = 2.3,\n            \"city\"      = 1.5\n           )\n\ntemps <- c(0.3, 1, 5, 10)\nsoftmax_data <- softmax(values, temps)\n\n# Plot\nsoftmax_data |> ggplot(aes(y = reorder(word, -values[word]),\n                           x = prob, fill = temp)) +\n    geom_bar(stat = \"identity\") +\n    facet_wrap(~temp, nrow = 2, ncol = 2, \n               labeller = labeller(temp = function(x) paste(\"Temp =\", x))) +\n    labs(title = \"We live in Los Angeles, tomorrow we will travel to the ..\",\n         subtitle = \"Horizontal axis is probability\",\n         x = NULL, y = NULL) +\n    scale_fill_gradient(low = \"darkseagreen4\", high = \"darkorange\") + \n    theme_minimal() +\n    theme(\n        strip.text = element_text(face = \"bold\", size = 12), # facet labels\n        axis.title.x = element_text(face = \"bold\", size = 12), # X-axis label\n        axis.text.x = element_text(size = 11, face = \"bold\"),\n        axis.text.y = element_text(size = 11, face = \"bold\")\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}